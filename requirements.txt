import pandas as pd

# Charger les données
data = pd.read_csv("logs_proxy.csv")

# Convertir la colonne de date en type datetime
data['date'] = pd.to_datetime(data['date'])

# Créer la feature de jour de la semaine
data['day_of_week'] = data['date'].dt.dayofweek

# Créer la feature de mois
data['month'] = data['date'].dt.month

# Créer la feature de jour de la semaine
data['is_weekend'] = (data['day_of_week'] >= 5).astype(int)

# Calculer la fréquence d'accès par jour
access_frequency = data.groupby(['user', data['date'].dt.date])['date'].count().reset_index()
access_frequency.columns = ['user', 'date', 'access_frequency']
data = pd.merge(data, access_frequency, on=['user', 'date'], how='left')

# Calculer la fréquence d'accès par mois
monthly_access_frequency = data.groupby(['user', data['date'].dt.to_period('M')])['date'].count().reset_index()
monthly_access_frequency.columns = ['user', 'month', 'monthly_access_frequency']
data = pd.merge(data, monthly_access_frequency, on=['user', 'month'], how='left')

# Calculer la fréquence d'accès par jour de la semaine
weekly_access_frequency = data.groupby(['user', data['date'].dt.dayofweek])['date'].count().reset_index()
weekly_access_frequency.columns = ['user', 'day_of_week', 'weekly_access_frequency']
data = pd.merge(data, weekly_access_frequency, on=['user', 'day_of_week'], how='left')

# Afficher les premières lignes du dataset avec les nouvelles features
print(data.head())
